*******************************************************************

   Название : Прошивальщик 1.0
   Компания : ООО "Торговый баланс М"
              https://torgbalance.com/
              115184, г. Москва, ул. Большая Татарская, дом 35, стр. 3.
              Техническая поддержка: support@torgbalance.com, +7(495)323-64-22

*******************************************************************

  Утилита предназначена для обновления ПО ФР. 
  
  Алгоритм работы утилиты:
  1. Получение информации о ККМ
  2. Чтение денежного регистра, если RestoreCashRegister = true
  3. Чтение значений таблиц, если SaveTables = true
  4. Проверка, что состояние ККМ = 4, закрытая смена
  5. Форматирование SD карты
  6. Поиск в цикле подходящего загрузчика и запись его через DFU или XModem
     Таким образом можно записать несколько загрузчиков, например: 
	 153 -> 155 -> 1939
  7. Поиск и обновление ПО ФР через DFU или XModem
	 После обновления ПО ФР таблицы принимают значения по-умолчанию.
     Поэтому если подключение было TCP через RNDIS, то оно может стать VCOM.
	 Поиск устройства и проверка версии ПО ФР.
  8. Если параметр SaveTables = true, то записываем значения таблиц
  9. Если для ПО ФР заданы дополнительные значения таблиц, то они записываются.
  10. Если в файле rules.json есть элемент записи таблиц, ACTION_WRITE_TABLES = 6,
      то записываем эти таблицы
  11. Перезагружаем ФР и повторно читаем параметры драйвера ФР, метод LoadParams.
      Драйвер читает параметры как при загрузке. Проверяем связь с ФР. 
  12. Выполняем действия инициализации архива ФН, фискализации, перефискализации или записи лицензии.

*******************************************************************

  Возможные действия утилиты:
    
  ACTION_UPDATE_LOADER    = 1; // Обновление загрузчика
  ACTION_UPDATE_FIRMWARE  = 2; // Обновление программы
  ACTION_WRITE_LICENSE    = 3; // Запись лицензий
  ACTION_INIT_FS          = 4; // Инициализация тестового ФН
  ACTION_FISCALIZE_FS     = 5; // Фискализация ФН
  ACTION_WRITE_TABLES     = 6; // Запись таблиц
  ACTION_REFISCALIZE_FS   = 7; // Перерегистрация ФН

*******************************************************************
